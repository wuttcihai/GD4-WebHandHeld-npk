import { Component, ViewChild, ViewContainerRef, ViewEncapsulation } from "@angular/core";
import { ModalSize } from './modal-config';
import * as i0 from "@angular/core";
import * as i1 from "./modal-reference";
import * as i2 from "@angular/common";
export class ModalComponent {
    constructor(changeDetectorRef, modalRefernce) {
        this.modalSize = ModalSize;
        this._changeDetectorRef = changeDetectorRef;
        this.modalReference = modalRefernce;
    }
    createModalContent(componentType) {
        this.contentContainer.clear();
        return this.contentContainer.createComponent(componentType);
    }
    ngAfterViewInit() {
        this.componentRef = this.createModalContent(this.contentComponentType);
        // To update the view.
        this._changeDetectorRef.detectChanges();
        // To take focus from a button clicked behind the modal;
        this.bodyElement.nativeElement.focus();
    }
    ngOnDestroy() {
        if (this.componentRef) {
            this.componentRef.destroy();
        }
    }
    isBackdropElement(target) {
        let targetElement = target;
        if (targetElement.classList.contains('dp-backdrop')) {
            return true;
        }
        if (targetElement.classList.contains('dp-close-modal')) {
            return true;
        }
        return false;
    }
    mouseDownEvent(event, backdropCliecked) {
        // The backdropCliecked will be false if the event is just bubbled up from a child element.
        if (backdropCliecked && !this.isBackdropElement(event.target)) {
            return;
        }
        // Mark the mouse button pressed to check on the mouseUp event.
        this._mouseDownPressed = !this._mouseDownPressed;
    }
    mouseUpEvent(event) {
        // Check if the mouse was clicked on the backdrop.
        if (this._mouseDownPressed) {
            // Check if the mouse button was released on the backdrop
            if (this.isBackdropElement(event.target)) {
                // If mouse button was released on the backdrop, close the modal.
                event.stopPropagation();
                this.modalReference.cancel();
            }
        }
    }
    keyUpEvent(event) {
        // Close on the Esc key press.
        if (event.which === 27) {
            this.modalReference.cancel();
        }
    }
    maximize() {
        this.modalReference.config.mode = 'fullScreen';
    }
    restoreWindow() {
        this.modalReference.config.mode = 'default';
    }
    close() {
        this.modalReference.cancel();
    }
}
ModalComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "14.2.2", ngImport: i0, type: ModalComponent, deps: [{ token: i0.ChangeDetectorRef }, { token: i1.ModalReference }], target: i0.ɵɵFactoryTarget.Component });
ModalComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "14.2.2", type: ModalComponent, selector: "dp-modal", viewQueries: [{ propertyName: "contentContainer", first: true, predicate: ["contentContainer"], descendants: true, read: ViewContainerRef }, { propertyName: "bodyElement", first: true, predicate: ["bodyElement"], descendants: true }], ngImport: i0, template: "<div class=\"dp-backdrop dp-modal-backdrop\"\r\n     (mousedown)=\"mouseDownEvent($event, true)\"\r\n     (mouseup)=\"mouseUpEvent($event)\"\r\n     (keyup)=\"keyUpEvent($event)\">\r\n  <div class=\"dp-modal\"\r\n       [class.dp-large]=\"modalReference.config?.size === modalSize.large\"\r\n       [class.dp-extra-large]=\"modalReference.config?.size === modalSize.extraLarge\"\r\n       [class.dp-medium]=\"modalReference.config?.size === modalSize.medium\"\r\n       [class.dp-full-screen-modal]=\"modalReference.config?.mode === 'fullScreen'\"\r\n       [class.dp-disable-full-screen]=\"modalReference.config?.mode === 'disableFullScreen'\"\r\n       [class.dp-modal-position-top]=\"modalReference.config?.position === 'top'\"\r\n       [class.dp-modal-position-bottom]=\"modalReference.config?.position === 'bottom'\"\r\n       [class.dp-modal-position-left]=\"modalReference.config?.position === 'left'\"\r\n       [class.dp-modal-position-right]=\"modalReference.config?.position === 'right'\">\r\n\r\n    <div class=\"dp-modal-header\"\r\n         [class.dp-warning]=\"modalReference.config?.type === 'warning'\"\r\n         [class.dp-error]=\"modalReference.config?.type === 'error'\"\r\n         [class.dp-success]=\"modalReference.config?.type === 'success'\">\r\n      <h2 class=\"dp-title\">\r\n        {{modalReference.config?.title}}\r\n      </h2>\r\n\r\n      <ng-container *ngIf=\"modalReference.config?.mode != 'disableFullScreen'\">\r\n        <button *ngIf=\"modalReference.config?.mode != 'fullScreen'\"\r\n                (click)=\"maximize()\"\r\n                title=\"Maximize\"\r\n                aria-label=\"Maximize\">\r\n          <span class=\"material-icons\">\r\n            fullscreen\r\n          </span>\r\n        </button>\r\n\r\n        <button *ngIf=\"modalReference.config?.mode == 'fullScreen'\"\r\n                (click)=\"restoreWindow()\"\r\n                title=\"Restore Window Size\"\r\n                aria-label=\"Restore Window Size\">\r\n          <span class=\"material-icons\">\r\n            fullscreen_exit\r\n          </span>\r\n        </button>\r\n      </ng-container>\r\n      <button class=\"dp-close-modal\"\r\n              (click)=\"close()\"\r\n              title=\"Close\"\r\n              aria-label=\"Close\">\r\n        <span class=\"material-icons\">\r\n          close\r\n        </span>\r\n      </button>\r\n    </div>\r\n\r\n    <div #bodyElement class=\"dp-modal-body\" tabindex=\"-1\">\r\n      <ng-template #contentContainer></ng-template>\r\n    </div>\r\n  </div>\r\n</div>", styles: ["@import\"https://fonts.googleapis.com/icon?family=Material+Icons\";.dp-modal-backdrop{display:flex;align-items:center;justify-content:center}.dp-backdrop{position:fixed;width:100%;height:100%;inset:0;z-index:49;background-color:#313a4259}.dp-modal{display:flex;flex-direction:column;min-width:280px;min-height:100px;max-width:800px;transition:all .4s cubic-bezier(.65,.07,.35,.92);opacity:0;filter:alpha(opacity=0);transform:scale(.3);background-color:#fff;border-radius:5px;overflow:auto;max-height:95%;position:absolute}.dp-modal.dp-modal-position-top{top:-100%}.dp-modal.dp-modal-position-bottom{bottom:-100%}.dp-modal.dp-modal-position-left{left:-100%}.dp-modal.dp-modal-position-right{right:-100%}.dp-modal.dp-modal-position-top,.dp-modal.dp-modal-position-bottom{width:100%;min-width:100%;height:50%}.dp-modal.dp-modal-position-left,.dp-modal.dp-modal-position-right{height:100%;min-height:100%;width:0}.dp-modal.dp-modal-position-top,.dp-modal.dp-modal-position-bottom,.dp-modal.dp-modal-position-left,.dp-modal.dp-modal-position-right{transition:all .4s ease-in-out;transform:scale(1);border-radius:0}.dp-modal.dp-modal-position-top .dp-modal-header,.dp-modal.dp-modal-position-bottom .dp-modal-header,.dp-modal.dp-modal-position-left .dp-modal-header,.dp-modal.dp-modal-position-right .dp-modal-header{border-radius:0}.dp-visible .dp-modal{transform:scale(1);opacity:1;filter:alpha(opacity=100)}.dp-visible .dp-modal.dp-modal-position-top{top:0}.dp-visible .dp-modal.dp-modal-position-bottom{bottom:0}.dp-visible .dp-modal.dp-modal-position-left{left:0}.dp-visible .dp-modal.dp-modal-position-right{right:0}.dp-modal-header{display:flex;background-color:#244b8c;border-radius:5px 5px 0 0;color:#e2dfdf;padding:1px 1px 1px 14px}.dp-modal-header button{border:0;background-color:transparent;color:#e2dfdf;padding:8px}.dp-modal-header .dp-title{font-size:20px;margin:.7rem 0;width:calc(100% - 35px)}.dp-modal-body{padding:20px;overflow:auto;outline:none;height:100%}.dp-modal.dp-large{min-width:40%}.dp-modal.dp-extra-large{min-width:70%}@media screen and (max-width: 1400px){.dp-modal.dp-large{min-width:40%}}@media screen and (max-width: 1200px){.dp-modal,.dp-modal.dp-large{max-width:80%;min-width:60%}.dp-modal.dp-extra-large{max-width:80%;min-width:80%}}.dp-modal.dp-full-screen-modal,.dp-modal.dp-large.dp-full-screen-modal,.dp-modal.dp-extra-large.dp-full-screen-modal{width:100%;min-width:100%;height:100%;min-height:100%;max-height:100%;max-width:none}.dp-modal.dp-full-screen-modal,.dp-modal.dp-full-screen-modal .dp-modal-header,.dp-modal.dp-large.dp-full-screen-modal,.dp-modal.dp-large.dp-full-screen-modal .dp-modal-header,.dp-modal.dp-extra-large.dp-full-screen-modal,.dp-modal.dp-extra-large.dp-full-screen-modal .dp-modal-header{border-radius:0}@media screen and (max-width: 960px){.dp-modal:not(.dp-disable-full-screen),.dp-modal.dp-large:not(.dp-disable-full-screen),.dp-modal.dp-extra-large:not(.dp-disable-full-screen){width:100%;min-width:100%;height:100%;min-height:95%;max-height:100%;max-width:none}.dp-modal,.dp-modal-header{border-radius:0}}.dp-warning{background-color:#df9308}.dp-success{background-color:#0e940e}.dp-error{background-color:#c41111}\n"], dependencies: [{ kind: "directive", type: i2.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }], encapsulation: i0.ViewEncapsulation.None });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "14.2.2", ngImport: i0, type: ModalComponent, decorators: [{
            type: Component,
            args: [{ selector: 'dp-modal', encapsulation: ViewEncapsulation.None, template: "<div class=\"dp-backdrop dp-modal-backdrop\"\r\n     (mousedown)=\"mouseDownEvent($event, true)\"\r\n     (mouseup)=\"mouseUpEvent($event)\"\r\n     (keyup)=\"keyUpEvent($event)\">\r\n  <div class=\"dp-modal\"\r\n       [class.dp-large]=\"modalReference.config?.size === modalSize.large\"\r\n       [class.dp-extra-large]=\"modalReference.config?.size === modalSize.extraLarge\"\r\n       [class.dp-medium]=\"modalReference.config?.size === modalSize.medium\"\r\n       [class.dp-full-screen-modal]=\"modalReference.config?.mode === 'fullScreen'\"\r\n       [class.dp-disable-full-screen]=\"modalReference.config?.mode === 'disableFullScreen'\"\r\n       [class.dp-modal-position-top]=\"modalReference.config?.position === 'top'\"\r\n       [class.dp-modal-position-bottom]=\"modalReference.config?.position === 'bottom'\"\r\n       [class.dp-modal-position-left]=\"modalReference.config?.position === 'left'\"\r\n       [class.dp-modal-position-right]=\"modalReference.config?.position === 'right'\">\r\n\r\n    <div class=\"dp-modal-header\"\r\n         [class.dp-warning]=\"modalReference.config?.type === 'warning'\"\r\n         [class.dp-error]=\"modalReference.config?.type === 'error'\"\r\n         [class.dp-success]=\"modalReference.config?.type === 'success'\">\r\n      <h2 class=\"dp-title\">\r\n        {{modalReference.config?.title}}\r\n      </h2>\r\n\r\n      <ng-container *ngIf=\"modalReference.config?.mode != 'disableFullScreen'\">\r\n        <button *ngIf=\"modalReference.config?.mode != 'fullScreen'\"\r\n                (click)=\"maximize()\"\r\n                title=\"Maximize\"\r\n                aria-label=\"Maximize\">\r\n          <span class=\"material-icons\">\r\n            fullscreen\r\n          </span>\r\n        </button>\r\n\r\n        <button *ngIf=\"modalReference.config?.mode == 'fullScreen'\"\r\n                (click)=\"restoreWindow()\"\r\n                title=\"Restore Window Size\"\r\n                aria-label=\"Restore Window Size\">\r\n          <span class=\"material-icons\">\r\n            fullscreen_exit\r\n          </span>\r\n        </button>\r\n      </ng-container>\r\n      <button class=\"dp-close-modal\"\r\n              (click)=\"close()\"\r\n              title=\"Close\"\r\n              aria-label=\"Close\">\r\n        <span class=\"material-icons\">\r\n          close\r\n        </span>\r\n      </button>\r\n    </div>\r\n\r\n    <div #bodyElement class=\"dp-modal-body\" tabindex=\"-1\">\r\n      <ng-template #contentContainer></ng-template>\r\n    </div>\r\n  </div>\r\n</div>", styles: ["@import\"https://fonts.googleapis.com/icon?family=Material+Icons\";.dp-modal-backdrop{display:flex;align-items:center;justify-content:center}.dp-backdrop{position:fixed;width:100%;height:100%;inset:0;z-index:49;background-color:#313a4259}.dp-modal{display:flex;flex-direction:column;min-width:280px;min-height:100px;max-width:800px;transition:all .4s cubic-bezier(.65,.07,.35,.92);opacity:0;filter:alpha(opacity=0);transform:scale(.3);background-color:#fff;border-radius:5px;overflow:auto;max-height:95%;position:absolute}.dp-modal.dp-modal-position-top{top:-100%}.dp-modal.dp-modal-position-bottom{bottom:-100%}.dp-modal.dp-modal-position-left{left:-100%}.dp-modal.dp-modal-position-right{right:-100%}.dp-modal.dp-modal-position-top,.dp-modal.dp-modal-position-bottom{width:100%;min-width:100%;height:50%}.dp-modal.dp-modal-position-left,.dp-modal.dp-modal-position-right{height:100%;min-height:100%;width:0}.dp-modal.dp-modal-position-top,.dp-modal.dp-modal-position-bottom,.dp-modal.dp-modal-position-left,.dp-modal.dp-modal-position-right{transition:all .4s ease-in-out;transform:scale(1);border-radius:0}.dp-modal.dp-modal-position-top .dp-modal-header,.dp-modal.dp-modal-position-bottom .dp-modal-header,.dp-modal.dp-modal-position-left .dp-modal-header,.dp-modal.dp-modal-position-right .dp-modal-header{border-radius:0}.dp-visible .dp-modal{transform:scale(1);opacity:1;filter:alpha(opacity=100)}.dp-visible .dp-modal.dp-modal-position-top{top:0}.dp-visible .dp-modal.dp-modal-position-bottom{bottom:0}.dp-visible .dp-modal.dp-modal-position-left{left:0}.dp-visible .dp-modal.dp-modal-position-right{right:0}.dp-modal-header{display:flex;background-color:#244b8c;border-radius:5px 5px 0 0;color:#e2dfdf;padding:1px 1px 1px 14px}.dp-modal-header button{border:0;background-color:transparent;color:#e2dfdf;padding:8px}.dp-modal-header .dp-title{font-size:20px;margin:.7rem 0;width:calc(100% - 35px)}.dp-modal-body{padding:20px;overflow:auto;outline:none;height:100%}.dp-modal.dp-large{min-width:40%}.dp-modal.dp-extra-large{min-width:70%}@media screen and (max-width: 1400px){.dp-modal.dp-large{min-width:40%}}@media screen and (max-width: 1200px){.dp-modal,.dp-modal.dp-large{max-width:80%;min-width:60%}.dp-modal.dp-extra-large{max-width:80%;min-width:80%}}.dp-modal.dp-full-screen-modal,.dp-modal.dp-large.dp-full-screen-modal,.dp-modal.dp-extra-large.dp-full-screen-modal{width:100%;min-width:100%;height:100%;min-height:100%;max-height:100%;max-width:none}.dp-modal.dp-full-screen-modal,.dp-modal.dp-full-screen-modal .dp-modal-header,.dp-modal.dp-large.dp-full-screen-modal,.dp-modal.dp-large.dp-full-screen-modal .dp-modal-header,.dp-modal.dp-extra-large.dp-full-screen-modal,.dp-modal.dp-extra-large.dp-full-screen-modal .dp-modal-header{border-radius:0}@media screen and (max-width: 960px){.dp-modal:not(.dp-disable-full-screen),.dp-modal.dp-large:not(.dp-disable-full-screen),.dp-modal.dp-extra-large:not(.dp-disable-full-screen){width:100%;min-width:100%;height:100%;min-height:95%;max-height:100%;max-width:none}.dp-modal,.dp-modal-header{border-radius:0}}.dp-warning{background-color:#df9308}.dp-success{background-color:#0e940e}.dp-error{background-color:#c41111}\n"] }]
        }], ctorParameters: function () { return [{ type: i0.ChangeDetectorRef }, { type: i1.ModalReference }]; }, propDecorators: { contentContainer: [{
                type: ViewChild,
                args: ['contentContainer', { read: ViewContainerRef }]
            }], bodyElement: [{
                type: ViewChild,
                args: ['bodyElement']
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibW9kYWwuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vcHJvamVjdHMvbmd4LW1vZGFsLWRpYWxvZy9zcmMvbGliL21vZGFsLmNvbXBvbmVudC50cyIsIi4uLy4uLy4uLy4uL3Byb2plY3RzL25neC1tb2RhbC1kaWFsb2cvc3JjL2xpYi9tb2RhbC5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFnQixTQUFTLEVBQUUsZ0JBQWdCLEVBQWlFLGlCQUFpQixFQUFFLE1BQU0sZUFBZSxDQUFDO0FBRXZLLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQzs7OztBQVUzQyxNQUFNLE9BQU8sY0FBYztJQWlCekIsWUFDRSxpQkFBb0MsRUFDcEMsYUFBdUM7UUFYbEMsY0FBUyxHQUFHLFNBQVMsQ0FBQztRQWEzQixJQUFJLENBQUMsa0JBQWtCLEdBQUcsaUJBQWlCLENBQUM7UUFDNUMsSUFBSSxDQUFDLGNBQWMsR0FBRyxhQUFhLENBQUM7SUFDdEMsQ0FBQztJQUVPLGtCQUFrQixDQUFDLGFBQXdCO1FBQ2pELElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUM5QixPQUFPLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxlQUFlLENBQUMsYUFBYSxDQUFDLENBQUM7SUFDOUQsQ0FBQztJQUVNLGVBQWU7UUFDcEIsSUFBSSxDQUFDLFlBQVksR0FBRyxJQUFJLENBQUMsa0JBQWtCLENBQUMsSUFBSSxDQUFDLG9CQUFvQixDQUFDLENBQUM7UUFFdkUsc0JBQXNCO1FBQ3RCLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxhQUFhLEVBQUUsQ0FBQztRQUV4Qyx3REFBd0Q7UUFDeEQsSUFBSSxDQUFDLFdBQVcsQ0FBQyxhQUFhLENBQUMsS0FBSyxFQUFFLENBQUM7SUFDekMsQ0FBQztJQUVNLFdBQVc7UUFDaEIsSUFBSSxJQUFJLENBQUMsWUFBWSxFQUFFO1lBQ3JCLElBQUksQ0FBQyxZQUFZLENBQUMsT0FBTyxFQUFFLENBQUM7U0FDN0I7SUFDSCxDQUFDO0lBRU8saUJBQWlCLENBQUMsTUFBbUI7UUFDM0MsSUFBSSxhQUFhLEdBQWdCLE1BQU0sQ0FBQztRQUV4QyxJQUFJLGFBQWEsQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLGFBQWEsQ0FBQyxFQUFFO1lBQ25ELE9BQU8sSUFBSSxDQUFDO1NBQ2I7UUFDRCxJQUFJLGFBQWEsQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLGdCQUFnQixDQUFDLEVBQUU7WUFDdEQsT0FBTyxJQUFJLENBQUM7U0FDYjtRQUVELE9BQU8sS0FBSyxDQUFDO0lBQ2YsQ0FBQztJQUVNLGNBQWMsQ0FBQyxLQUFpQixFQUFFLGdCQUF5QjtRQUNoRSwyRkFBMkY7UUFDM0YsSUFBSSxnQkFBZ0IsSUFBSSxDQUFDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLEVBQUU7WUFDN0QsT0FBTTtTQUNQO1FBRUQsK0RBQStEO1FBQy9ELElBQUksQ0FBQyxpQkFBaUIsR0FBRyxDQUFDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQztJQUNuRCxDQUFDO0lBRU0sWUFBWSxDQUFDLEtBQWlCO1FBQ25DLGtEQUFrRDtRQUNsRCxJQUFJLElBQUksQ0FBQyxpQkFBaUIsRUFBRTtZQUMxQix5REFBeUQ7WUFDekQsSUFBSSxJQUFJLENBQUMsaUJBQWlCLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxFQUFFO2dCQUN4QyxpRUFBaUU7Z0JBQ2pFLEtBQUssQ0FBQyxlQUFlLEVBQUUsQ0FBQztnQkFDeEIsSUFBSSxDQUFDLGNBQWMsQ0FBQyxNQUFNLEVBQUUsQ0FBQzthQUM5QjtTQUNGO0lBQ0gsQ0FBQztJQUVNLFVBQVUsQ0FBQyxLQUFvQjtRQUNwQyw4QkFBOEI7UUFDOUIsSUFBSSxLQUFLLENBQUMsS0FBSyxLQUFLLEVBQUUsRUFBRTtZQUN0QixJQUFJLENBQUMsY0FBYyxDQUFDLE1BQU0sRUFBRSxDQUFDO1NBQzlCO0lBQ0gsQ0FBQztJQUVNLFFBQVE7UUFDYixJQUFJLENBQUMsY0FBYyxDQUFDLE1BQU0sQ0FBQyxJQUFJLEdBQUcsWUFBWSxDQUFDO0lBQ2pELENBQUM7SUFFTSxhQUFhO1FBQ2xCLElBQUksQ0FBQyxjQUFjLENBQUMsTUFBTSxDQUFDLElBQUksR0FBRyxTQUFTLENBQUM7SUFDOUMsQ0FBQztJQUVNLEtBQUs7UUFDVixJQUFJLENBQUMsY0FBYyxDQUFDLE1BQU0sRUFBRSxDQUFDO0lBQy9CLENBQUM7OzJHQWxHVSxjQUFjOytGQUFkLGNBQWMsaUpBV2MsZ0JBQWdCLDBIQ3ZCekQsaWdGQXdETTsyRkQ1Q08sY0FBYztrQkFSMUIsU0FBUzsrQkFDRSxVQUFVLGlCQUtMLGlCQUFpQixDQUFDLElBQUk7cUlBYzlCLGdCQUFnQjtzQkFEdEIsU0FBUzt1QkFBQyxrQkFBa0IsRUFBRSxFQUFFLElBQUksRUFBRSxnQkFBZ0IsRUFBRTtnQkFJbEQsV0FBVztzQkFEakIsU0FBUzt1QkFBQyxhQUFhIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBDb21wb25lbnRSZWYsIFZpZXdDaGlsZCwgVmlld0NvbnRhaW5lclJlZiwgQWZ0ZXJWaWV3SW5pdCwgVHlwZSwgQ2hhbmdlRGV0ZWN0b3JSZWYsIEVsZW1lbnRSZWYsIE9uRGVzdHJveSwgVmlld0VuY2Fwc3VsYXRpb24gfSBmcm9tIFwiQGFuZ3VsYXIvY29yZVwiO1xyXG5pbXBvcnQgeyBNb2RhbFJlZmVyZW5jZSB9IGZyb20gJy4vbW9kYWwtcmVmZXJlbmNlJztcclxuaW1wb3J0IHsgTW9kYWxTaXplIH0gZnJvbSAnLi9tb2RhbC1jb25maWcnO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICdkcC1tb2RhbCcsXHJcbiAgdGVtcGxhdGVVcmw6ICcuL21vZGFsLmNvbXBvbmVudC5odG1sJyxcclxuICBzdHlsZVVybHM6IFtcclxuICAgICcuL21vZGFsLmNvbXBvbmVudC5zY3NzJ1xyXG4gIF0sXHJcbiAgZW5jYXBzdWxhdGlvbjogVmlld0VuY2Fwc3VsYXRpb24uTm9uZVxyXG59KVxyXG5leHBvcnQgY2xhc3MgTW9kYWxDb21wb25lbnQgaW1wbGVtZW50cyBBZnRlclZpZXdJbml0LCBPbkRlc3Ryb3kge1xyXG4gIHByaXZhdGUgX2NoYW5nZURldGVjdG9yUmVmOiBDaGFuZ2VEZXRlY3RvclJlZjtcclxuXHJcbiAgcHJpdmF0ZSBfbW91c2VEb3duUHJlc3NlZDogYm9vbGVhbjtcclxuXHJcbiAgcHVibGljIG1vZGFsUmVmZXJlbmNlOiBNb2RhbFJlZmVyZW5jZTxhbnk+O1xyXG4gIHB1YmxpYyBjb21wb25lbnRSZWY6IENvbXBvbmVudFJlZjxhbnk+O1xyXG4gIHB1YmxpYyBjb250ZW50Q29tcG9uZW50VHlwZTogVHlwZTxhbnk+O1xyXG4gIHB1YmxpYyBtb2RhbFNpemUgPSBNb2RhbFNpemU7XHJcbiAgcHVibGljIGNsYXNzQ29uZmlnOiBhbnk7XHJcblxyXG4gIEBWaWV3Q2hpbGQoJ2NvbnRlbnRDb250YWluZXInLCB7IHJlYWQ6IFZpZXdDb250YWluZXJSZWYgfSlcclxuICBwdWJsaWMgY29udGVudENvbnRhaW5lcjogVmlld0NvbnRhaW5lclJlZjtcclxuXHJcbiAgQFZpZXdDaGlsZCgnYm9keUVsZW1lbnQnKVxyXG4gIHB1YmxpYyBib2R5RWxlbWVudDogRWxlbWVudFJlZjxIVE1MRWxlbWVudD47XHJcblxyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgY2hhbmdlRGV0ZWN0b3JSZWY6IENoYW5nZURldGVjdG9yUmVmLFxyXG4gICAgbW9kYWxSZWZlcm5jZTogTW9kYWxSZWZlcmVuY2U8YW55LCBhbnk+XHJcbiAgKSB7XHJcbiAgICB0aGlzLl9jaGFuZ2VEZXRlY3RvclJlZiA9IGNoYW5nZURldGVjdG9yUmVmO1xyXG4gICAgdGhpcy5tb2RhbFJlZmVyZW5jZSA9IG1vZGFsUmVmZXJuY2U7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGNyZWF0ZU1vZGFsQ29udGVudChjb21wb25lbnRUeXBlOiBUeXBlPGFueT4pOiBDb21wb25lbnRSZWY8YW55PiB7XHJcbiAgICB0aGlzLmNvbnRlbnRDb250YWluZXIuY2xlYXIoKTtcclxuICAgIHJldHVybiB0aGlzLmNvbnRlbnRDb250YWluZXIuY3JlYXRlQ29tcG9uZW50KGNvbXBvbmVudFR5cGUpO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIG5nQWZ0ZXJWaWV3SW5pdCgpOiB2b2lkIHtcclxuICAgIHRoaXMuY29tcG9uZW50UmVmID0gdGhpcy5jcmVhdGVNb2RhbENvbnRlbnQodGhpcy5jb250ZW50Q29tcG9uZW50VHlwZSk7XHJcblxyXG4gICAgLy8gVG8gdXBkYXRlIHRoZSB2aWV3LlxyXG4gICAgdGhpcy5fY2hhbmdlRGV0ZWN0b3JSZWYuZGV0ZWN0Q2hhbmdlcygpO1xyXG5cclxuICAgIC8vIFRvIHRha2UgZm9jdXMgZnJvbSBhIGJ1dHRvbiBjbGlja2VkIGJlaGluZCB0aGUgbW9kYWw7XHJcbiAgICB0aGlzLmJvZHlFbGVtZW50Lm5hdGl2ZUVsZW1lbnQuZm9jdXMoKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBuZ09uRGVzdHJveSgpOiB2b2lkIHtcclxuICAgIGlmICh0aGlzLmNvbXBvbmVudFJlZikge1xyXG4gICAgICB0aGlzLmNvbXBvbmVudFJlZi5kZXN0cm95KCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGlzQmFja2Ryb3BFbGVtZW50KHRhcmdldDogRXZlbnRUYXJnZXQpOiBib29sZWFuIHtcclxuICAgIGxldCB0YXJnZXRFbGVtZW50ID0gPEhUTUxFbGVtZW50PnRhcmdldDtcclxuXHJcbiAgICBpZiAodGFyZ2V0RWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2RwLWJhY2tkcm9wJykpIHtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbiAgICBpZiAodGFyZ2V0RWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2RwLWNsb3NlLW1vZGFsJykpIHtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIG1vdXNlRG93bkV2ZW50KGV2ZW50OiBNb3VzZUV2ZW50LCBiYWNrZHJvcENsaWVja2VkOiBib29sZWFuKTogdm9pZCB7XHJcbiAgICAvLyBUaGUgYmFja2Ryb3BDbGllY2tlZCB3aWxsIGJlIGZhbHNlIGlmIHRoZSBldmVudCBpcyBqdXN0IGJ1YmJsZWQgdXAgZnJvbSBhIGNoaWxkIGVsZW1lbnQuXHJcbiAgICBpZiAoYmFja2Ryb3BDbGllY2tlZCAmJiAhdGhpcy5pc0JhY2tkcm9wRWxlbWVudChldmVudC50YXJnZXQpKSB7XHJcbiAgICAgIHJldHVyblxyXG4gICAgfVxyXG5cclxuICAgIC8vIE1hcmsgdGhlIG1vdXNlIGJ1dHRvbiBwcmVzc2VkIHRvIGNoZWNrIG9uIHRoZSBtb3VzZVVwIGV2ZW50LlxyXG4gICAgdGhpcy5fbW91c2VEb3duUHJlc3NlZCA9ICF0aGlzLl9tb3VzZURvd25QcmVzc2VkO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIG1vdXNlVXBFdmVudChldmVudDogTW91c2VFdmVudCk6IHZvaWQge1xyXG4gICAgLy8gQ2hlY2sgaWYgdGhlIG1vdXNlIHdhcyBjbGlja2VkIG9uIHRoZSBiYWNrZHJvcC5cclxuICAgIGlmICh0aGlzLl9tb3VzZURvd25QcmVzc2VkKSB7XHJcbiAgICAgIC8vIENoZWNrIGlmIHRoZSBtb3VzZSBidXR0b24gd2FzIHJlbGVhc2VkIG9uIHRoZSBiYWNrZHJvcFxyXG4gICAgICBpZiAodGhpcy5pc0JhY2tkcm9wRWxlbWVudChldmVudC50YXJnZXQpKSB7XHJcbiAgICAgICAgLy8gSWYgbW91c2UgYnV0dG9uIHdhcyByZWxlYXNlZCBvbiB0aGUgYmFja2Ryb3AsIGNsb3NlIHRoZSBtb2RhbC5cclxuICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICB0aGlzLm1vZGFsUmVmZXJlbmNlLmNhbmNlbCgpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwdWJsaWMga2V5VXBFdmVudChldmVudDogS2V5Ym9hcmRFdmVudCk6IHZvaWQge1xyXG4gICAgLy8gQ2xvc2Ugb24gdGhlIEVzYyBrZXkgcHJlc3MuXHJcbiAgICBpZiAoZXZlbnQud2hpY2ggPT09IDI3KSB7XHJcbiAgICAgIHRoaXMubW9kYWxSZWZlcmVuY2UuY2FuY2VsKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgbWF4aW1pemUoKTogdm9pZCB7XHJcbiAgICB0aGlzLm1vZGFsUmVmZXJlbmNlLmNvbmZpZy5tb2RlID0gJ2Z1bGxTY3JlZW4nO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHJlc3RvcmVXaW5kb3coKTogdm9pZCB7XHJcbiAgICB0aGlzLm1vZGFsUmVmZXJlbmNlLmNvbmZpZy5tb2RlID0gJ2RlZmF1bHQnO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGNsb3NlKCkge1xyXG4gICAgdGhpcy5tb2RhbFJlZmVyZW5jZS5jYW5jZWwoKTtcclxuICB9XHJcbn1cclxuIiwiPGRpdiBjbGFzcz1cImRwLWJhY2tkcm9wIGRwLW1vZGFsLWJhY2tkcm9wXCJcclxuICAgICAobW91c2Vkb3duKT1cIm1vdXNlRG93bkV2ZW50KCRldmVudCwgdHJ1ZSlcIlxyXG4gICAgIChtb3VzZXVwKT1cIm1vdXNlVXBFdmVudCgkZXZlbnQpXCJcclxuICAgICAoa2V5dXApPVwia2V5VXBFdmVudCgkZXZlbnQpXCI+XHJcbiAgPGRpdiBjbGFzcz1cImRwLW1vZGFsXCJcclxuICAgICAgIFtjbGFzcy5kcC1sYXJnZV09XCJtb2RhbFJlZmVyZW5jZS5jb25maWc/LnNpemUgPT09IG1vZGFsU2l6ZS5sYXJnZVwiXHJcbiAgICAgICBbY2xhc3MuZHAtZXh0cmEtbGFyZ2VdPVwibW9kYWxSZWZlcmVuY2UuY29uZmlnPy5zaXplID09PSBtb2RhbFNpemUuZXh0cmFMYXJnZVwiXHJcbiAgICAgICBbY2xhc3MuZHAtbWVkaXVtXT1cIm1vZGFsUmVmZXJlbmNlLmNvbmZpZz8uc2l6ZSA9PT0gbW9kYWxTaXplLm1lZGl1bVwiXHJcbiAgICAgICBbY2xhc3MuZHAtZnVsbC1zY3JlZW4tbW9kYWxdPVwibW9kYWxSZWZlcmVuY2UuY29uZmlnPy5tb2RlID09PSAnZnVsbFNjcmVlbidcIlxyXG4gICAgICAgW2NsYXNzLmRwLWRpc2FibGUtZnVsbC1zY3JlZW5dPVwibW9kYWxSZWZlcmVuY2UuY29uZmlnPy5tb2RlID09PSAnZGlzYWJsZUZ1bGxTY3JlZW4nXCJcclxuICAgICAgIFtjbGFzcy5kcC1tb2RhbC1wb3NpdGlvbi10b3BdPVwibW9kYWxSZWZlcmVuY2UuY29uZmlnPy5wb3NpdGlvbiA9PT0gJ3RvcCdcIlxyXG4gICAgICAgW2NsYXNzLmRwLW1vZGFsLXBvc2l0aW9uLWJvdHRvbV09XCJtb2RhbFJlZmVyZW5jZS5jb25maWc/LnBvc2l0aW9uID09PSAnYm90dG9tJ1wiXHJcbiAgICAgICBbY2xhc3MuZHAtbW9kYWwtcG9zaXRpb24tbGVmdF09XCJtb2RhbFJlZmVyZW5jZS5jb25maWc/LnBvc2l0aW9uID09PSAnbGVmdCdcIlxyXG4gICAgICAgW2NsYXNzLmRwLW1vZGFsLXBvc2l0aW9uLXJpZ2h0XT1cIm1vZGFsUmVmZXJlbmNlLmNvbmZpZz8ucG9zaXRpb24gPT09ICdyaWdodCdcIj5cclxuXHJcbiAgICA8ZGl2IGNsYXNzPVwiZHAtbW9kYWwtaGVhZGVyXCJcclxuICAgICAgICAgW2NsYXNzLmRwLXdhcm5pbmddPVwibW9kYWxSZWZlcmVuY2UuY29uZmlnPy50eXBlID09PSAnd2FybmluZydcIlxyXG4gICAgICAgICBbY2xhc3MuZHAtZXJyb3JdPVwibW9kYWxSZWZlcmVuY2UuY29uZmlnPy50eXBlID09PSAnZXJyb3InXCJcclxuICAgICAgICAgW2NsYXNzLmRwLXN1Y2Nlc3NdPVwibW9kYWxSZWZlcmVuY2UuY29uZmlnPy50eXBlID09PSAnc3VjY2VzcydcIj5cclxuICAgICAgPGgyIGNsYXNzPVwiZHAtdGl0bGVcIj5cclxuICAgICAgICB7e21vZGFsUmVmZXJlbmNlLmNvbmZpZz8udGl0bGV9fVxyXG4gICAgICA8L2gyPlxyXG5cclxuICAgICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cIm1vZGFsUmVmZXJlbmNlLmNvbmZpZz8ubW9kZSAhPSAnZGlzYWJsZUZ1bGxTY3JlZW4nXCI+XHJcbiAgICAgICAgPGJ1dHRvbiAqbmdJZj1cIm1vZGFsUmVmZXJlbmNlLmNvbmZpZz8ubW9kZSAhPSAnZnVsbFNjcmVlbidcIlxyXG4gICAgICAgICAgICAgICAgKGNsaWNrKT1cIm1heGltaXplKClcIlxyXG4gICAgICAgICAgICAgICAgdGl0bGU9XCJNYXhpbWl6ZVwiXHJcbiAgICAgICAgICAgICAgICBhcmlhLWxhYmVsPVwiTWF4aW1pemVcIj5cclxuICAgICAgICAgIDxzcGFuIGNsYXNzPVwibWF0ZXJpYWwtaWNvbnNcIj5cclxuICAgICAgICAgICAgZnVsbHNjcmVlblxyXG4gICAgICAgICAgPC9zcGFuPlxyXG4gICAgICAgIDwvYnV0dG9uPlxyXG5cclxuICAgICAgICA8YnV0dG9uICpuZ0lmPVwibW9kYWxSZWZlcmVuY2UuY29uZmlnPy5tb2RlID09ICdmdWxsU2NyZWVuJ1wiXHJcbiAgICAgICAgICAgICAgICAoY2xpY2spPVwicmVzdG9yZVdpbmRvdygpXCJcclxuICAgICAgICAgICAgICAgIHRpdGxlPVwiUmVzdG9yZSBXaW5kb3cgU2l6ZVwiXHJcbiAgICAgICAgICAgICAgICBhcmlhLWxhYmVsPVwiUmVzdG9yZSBXaW5kb3cgU2l6ZVwiPlxyXG4gICAgICAgICAgPHNwYW4gY2xhc3M9XCJtYXRlcmlhbC1pY29uc1wiPlxyXG4gICAgICAgICAgICBmdWxsc2NyZWVuX2V4aXRcclxuICAgICAgICAgIDwvc3Bhbj5cclxuICAgICAgICA8L2J1dHRvbj5cclxuICAgICAgPC9uZy1jb250YWluZXI+XHJcbiAgICAgIDxidXR0b24gY2xhc3M9XCJkcC1jbG9zZS1tb2RhbFwiXHJcbiAgICAgICAgICAgICAgKGNsaWNrKT1cImNsb3NlKClcIlxyXG4gICAgICAgICAgICAgIHRpdGxlPVwiQ2xvc2VcIlxyXG4gICAgICAgICAgICAgIGFyaWEtbGFiZWw9XCJDbG9zZVwiPlxyXG4gICAgICAgIDxzcGFuIGNsYXNzPVwibWF0ZXJpYWwtaWNvbnNcIj5cclxuICAgICAgICAgIGNsb3NlXHJcbiAgICAgICAgPC9zcGFuPlxyXG4gICAgICA8L2J1dHRvbj5cclxuICAgIDwvZGl2PlxyXG5cclxuICAgIDxkaXYgI2JvZHlFbGVtZW50IGNsYXNzPVwiZHAtbW9kYWwtYm9keVwiIHRhYmluZGV4PVwiLTFcIj5cclxuICAgICAgPG5nLXRlbXBsYXRlICNjb250ZW50Q29udGFpbmVyPjwvbmctdGVtcGxhdGU+XHJcbiAgICA8L2Rpdj5cclxuICA8L2Rpdj5cclxuPC9kaXY+Il19